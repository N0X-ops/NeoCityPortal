<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NeoCity Access Terminal</title>
  <style>
    body {
      margin: 0;
      background-color: #000;
      color: #00ffff;
      font-family: 'Courier New', monospace;
      overflow: hidden;
    }
    .screen {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      text-align: center;
    }
    .glitch {
      font-size: 2em;
      color: #0ff;
      text-shadow: 0 0 5px #0ff, 0 0 10px #0ff, 0 0 20px #0ff;
      animation: flicker 1.5s infinite alternate;
    }
    @keyframes flicker {
      0% { opacity: 1; }
      50% { opacity: 0.8; }
      100% { opacity: 1; }
    }
    input {
      background: transparent;
      border: 1px solid #0ff;
      color: #0ff;
      padding: 10px;
      margin-top: 20px;
      outline: none;
      text-align: center;
    }
    button {
      background: none;
      border: 1px solid #0ff;
      color: #0ff;
      padding: 10px 20px;
      margin-top: 20px;
      cursor: pointer;
      transition: 0.3s;
    }
    button:hover {
      background: #0ff;
      color: #000;
      box-shadow: 0 0 20px #0ff;
    }
    .hidden { display: none; }
    .terminal-text {
      font-size: 1.2em;
      margin-top: 20px;
      white-space: pre-line;
    }
    .missions-btn {
      margin-top: 25px;
      padding: 12px 24px;
      border: 2px solid #00ffff;
      background: none;
      color: #00ffff;
      text-decoration: none;
      transition: 0.3s;
      font-weight: bold;
      letter-spacing: 2px;
    }
    .missions-btn:hover {
      background: #00ffff;
      color: #000;
      box-shadow: 0 0 20px #00ffff;
    }
    .flash {
      animation: flashEffect 0.15s infinite alternate;
    }
    @keyframes flashEffect {
      from { background-color: #000; }
      to { background-color: #00ffff; }
    }
  </style>
</head>
<body>
  <div class="screen" id="access-screen">
    <div class="glitch">NEOCITY ACCESS TERMINAL</div>
    <input type="text" id="username" placeholder="Enter your handle..." />
    <button onclick="grantAccess()">ENTER</button>
  </div>

  <div class="screen hidden" id="main-screen">
    <div class="glitch">ACCESS GRANTED</div>
    <div class="terminal-text" id="terminal"></div>
    <button id="tgLink">Enter NeoCity Telegram</button>
    <a href="missions.html" class="missions-btn">Enter the System</a>
  </div>

  <div class="screen hidden" id="reconnect-screen">
    <div class="glitch">Reconnecting to Terminal...</div>
  </div>

  <script>
    const accessScreen = document.getElementById('access-screen');
    const mainScreen = document.getElementById('main-screen');
    const reconnectScreen = document.getElementById('reconnect-screen');
    const terminal = document.getElementById('terminal');
    const tgLink = document.getElementById('tgLink');

    tgLink.onclick = () => {
      window.open('https://t.me/NeoCity202', '_blank');
    };

    // –µ—Å–ª–∏ —É–∂–µ –µ—Å—Ç—å –Ω–∏–∫ ‚Äî –æ—Ç–∫—Ä—ã–≤–∞–µ–º —Ç–µ—Ä–º–∏–Ω–∞–ª
    window.addEventListener('load', () => {
      const savedUser = localStorage.getItem('neocity_user');
      const fromReconnect = sessionStorage.getItem('from_reconnect');
      if (fromReconnect && savedUser) {
        sessionStorage.removeItem('from_reconnect');
        reconnectToTerminal(savedUser);
      } else if (savedUser) {
        showTerminal(savedUser);
      }
    });

    function grantAccess() {
      const username = document.getElementById('username').value.trim();
      if (!username) return alert('Enter your handle to access NeoCity.');
      localStorage.setItem('neocity_user', username);
      showTerminal(username);
    }

    function showTerminal(username) {
      accessScreen.classList.add('hidden');
      mainScreen.classList.remove('hidden');
      terminal.textContent = '';
      let messages = [
        'Initializing CyberLink...\n',
        'Decrypting access key...\n',
        'Verifying identity [' + username + ']...\n',
        'Access Granted. Welcome to NeoCity, ' + username + '.\n\n',
        'üï∂Ô∏è Loading system feeds...\n',
        '‚öôÔ∏è Synchronizing data streams...\n',
        '‚úÖ Terminal ready.'
      ];
      let index = 0;
      function type() {
        if (index < messages.length) {
          terminal.textContent += messages[index++];
          setTimeout(type, 800);
        }
      }
      type();
      playAmbient();
    }

    function reconnectToTerminal(username) {
      document.body.classList.add('flash');
      reconnectScreen.classList.remove('hidden');
      setTimeout(() => {
        document.body.classList.remove('flash');
        reconnectScreen.classList.add('hidden');
        showTerminal(username);
      }, 2500);
    }

    function playAmbient() {
      const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      const oscillator = audioCtx.createOscillator();
      const gainNode = audioCtx.createGain();
      oscillator.type = 'sine';
      oscillator.frequency.value = 220;
      gainNode.gain.value = 0.05;
      oscillator.connect(gainNode).connect(audioCtx.destination);
      oscillator.start();
    }

    // –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã missions
    if (document.referrer.includes('missions.html')) {
      const savedUser = localStorage.getItem('neocity_user');
      if (savedUser) {
        sessionStorage.setItem('from_reconnect', true);
        window.location.reload();
      }
    }
  </script>
</body>
</html>
